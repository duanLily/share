<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Promise.all</title>
  <script charset="UTF-8" src="../jquery.js"></script>
</head>
<body>

</body>
<script>
  /*let p1 = new Promise(function (resolve, reject) {
    //异步代码
    $.ajax({
      url: 'arr.txt',
      dataType: 'json',
      success(arr) {
        //resolve---成功了
        resolve(arr);
      },
      error(err) {
        //reject---失败了
        reject(err);
      }
    });
  });
  let p2 = new Promise(function (resolve, reject) {
    //异步代码
    $.ajax({
      url: 'json.txt',
      dataType: 'json',
      success(arr) {
        //resolve---成功了
        resolve(arr);
      },
      error(err) {
        //reject---失败了
        reject(err);
      }
    });
  });*/
  // 二合一
  /**
   * Promise.all
   *  全部都成功
   */
  function createPromise(url) {
    return new Promise(function (resolve, reject) {
      $.ajax({
        url,    // url:url;    两个一样时，留一个就好
        dataType: 'json',
        success(arr) {
          //resolve---成功了
          resolve(arr);
        },
        error(err) {
          //reject---失败了
          reject(err);
        }
      });
    });
  }

  Promise.all([
    // p1, p2
    createPromise("arr.txt"),
    createPromise("json.txt")
  ]).then(function (arr) {
    console.log("全部都成功了" + arr);
    let [res1, res2] = arr;
    console.log(res1);
    console.log(res2);
  }, function (err) {
    console.log("至少有一个失败了" + err);
  });
</script>
</html>
